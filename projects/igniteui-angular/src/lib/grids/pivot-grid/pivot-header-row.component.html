<div class="igx-grid-thead__wrapper" role="row" [style.width.px]="width" *ngIf="!row">
    <div class="igx-grid__tr" role="row" [style.width.px]="width">
        <div #pivotFilterContainer class="igx-grid__tr-action" [style.min-width.px]="grid.pivotRowWidths"
            (igxDragEnter)="onAreaDragEnter($event, filterArea, 2)" (igxDragLeave)="onAreaDragLeave($event, filterArea)"
            igxDrop (dropped)="onDimDrop($event, filterArea, 2)" (pointerdown)="$event.preventDefault()"
            style='display: flex; align-items: flex-end;'>
            <div *ngIf="grid.filterDimensions.length === 0">
                <span class='igx-pivot__emptyChipArea'>Drop Filter Fields here.</span>
            </div>
            <!-- Filter area -->
            <igx-chips-area #filterArea droppable='true' style="width:fit-content; height: 100%;">
                <igx-chip *ngFor="let filter of grid.filterDimensions" [id]="filter.memberName" [draggable]="true"
                    [removable]="true" (remove)="filterRemoved($event)"
                    (dragOver)="onDimDragOver($event, 2)"
                    (dragLeave)="onDimDragLeave($event)"
                    (dragDrop)="onDimDrop($event, filterArea, 2)"
                     >
                    <igx-icon igxPrefix>filter_list</igx-icon>
                    {{filter.memberName}}
                </igx-chip>
            </igx-chips-area>
        </div>

        <div>
            <div #pivotColumnContainer (dropped)="onDimDrop($event, colArea, 1)" igxDrop
                (igxDragEnter)="onAreaDragEnter($event, colArea, 1)" (igxDragLeave)="onAreaDragLeave($event, colArea)">
                <div *ngIf="grid.columnDimensions.length === 0">
                    <span class='igx-pivot__emptyChipArea'>Drop Column Fields here.</span>
                </div>
                <!-- Columns area -->
                <igx-chips-area #colArea droppable='true' style="width:fit-content; height: 100%;">
                    <igx-chip *ngFor="let col of grid.columnDimensions" [draggable]="'true'" [id]="col.memberName"
                        [removable]="true" (remove)="columnRemoved($event)"
                        (dragOver)="onDimDragOver($event, 1)"
                        (dragLeave)="onDimDragLeave($event)"
                        (dragDrop)="onDimDrop($event, colArea, 1)">
                        <igx-icon igxPrefix>view_column</igx-icon>
                        <igx-icon igxPrefix>filter_list</igx-icon>
                        {{col.memberName}}
                    </igx-chip>
                </igx-chips-area>
            </div>
            <div #pivotValueContainer [style.min-width.px]="grid.unpinnedWidth" (pointerdown)="$event.preventDefault()"
                (dropped)="onValueDrop($event, valueArea)" igxDrop
                (igxDragEnter)="onAreaDragEnter($event, valueArea)"
                (igxDragLeave)="onAreaDragLeave($event, valueArea)">

                <div *ngIf="grid.values.length === 0">
                    <span class='igx-pivot__emptyChipArea'>Drop Value Fields here.</span>
                </div>
                <!-- Value area -->
                <igx-chips-area #valueArea droppable='true' style="width:fit-content; height: 100%;">
                    <igx-chip *ngFor="let value of grid.values" [draggable]="'true'" [id]="value.member"
                        [removable]="true" (remove)="valueRemoved($event)"
                         (dragLeave)="onDimDragLeave($event)"
                         (dragOver)="onDimDragOver($event)"
                         (dragDrop)="onValueDrop($event, valueArea)">
                         <div igxPrefix (mousedown)='onSummaryClick($event, value, dropdown)' (pointerdown)='$event.stopPropagation()'
                         [igxDropDownItemNavigation]="dropdown">
                            <igx-icon>functions</igx-icon>
                            <igx-icon>arrow_drop_down</igx-icon>
                         </div>
                        {{value.displayName || value.member}}
                    </igx-chip>
                </igx-chips-area>
            </div>
        </div>
    </div>
</div>
<div role="rowgroup" class="igx-grid-thead__wrapper" [style.width.px]="width"
    [attr.aria-activedescendant]="activeDescendant" [class.igx-grid__tr--mrl]="hasMRL">
    <!-- Column headers area -->
    <div class="igx-grid__tr" role="row" [style.width.px]="width">

        <ng-container *ngIf="!row">
            <div #pivotContainer class="igx-grid__tr-action" [style.min-width.px]="grid.pivotRowWidths"
                (igxDragEnter)="onAreaDragEnter($event, rowArea, 0)" (igxDragLeave)="onAreaDragLeave($event, rowArea)"
                igxDrop (dropped)="onDimDrop($event, rowArea, 0)" (pointerdown)="$event.preventDefault()"
                style='display: flex; align-items: flex-end;'>

                <div *ngIf="grid.rowDimensions.length === 0">
                    <span class='igx-pivot__emptyChipArea'>Drop Row Fields here.</span>
                </div>
                <!-- Row area -->
                <igx-chips-area #rowArea droppable='true' style="width:fit-content; height: 100%;">
                    <igx-chip *ngFor="let row of grid.rowDimensions" [draggable]="'true'" [id]="row.memberName"
                        [removable]="true" (remove)="rowRemoved($event)"
                        (dragLeave)="onDimDragLeave($event)"
                        (dragDrop)="onDimDrop($event, rowArea, 0)"
                        (dragOver)="onDimDragOver($event, 0)">
                        <igx-icon igxPrefix>table_rows</igx-icon>
                        <igx-icon igxPrefix>filter_list</igx-icon>
                        {{ row.memberName}}
                    </igx-chip>
                </igx-chips-area>
            </div>
        </ng-container>

        <!-- Pinned columns collection from the start -->
        <ng-container *ngIf="pinnedColumnCollection.length && grid.isPinningToStart">
            <ng-container *ngFor="let column of pinnedColumnCollection | igxTopLevel">
                <igx-grid-header-group [ngClass]="column.headerGroupClasses"
                    [ngStyle]="column.headerGroupStyles | igxHeaderGroupStyle:column:grid.pipeTrigger" [column]="column"
                    [style.min-width]="column.calcWidth | igxHeaderGroupWidth:grid.defaultHeaderGroupMinWidth:hasMRL"
                    [style.flex-basis]="column.calcWidth | igxHeaderGroupWidth:grid.defaultHeaderGroupMinWidth:hasMRL">
                </igx-grid-header-group>
            </ng-container>
        </ng-container>

        <!-- Unpinned columns collection -->
        <ng-template igxGridFor #headerVirtualContainer let-column
            [igxGridForOf]="unpinnedColumnCollection | igxTopLevel" [igxForScrollContainer]="grid.parentVirtDir"
            [igxForContainerSize]=" row ? grid.pivotRowWidths : grid.unpinnedWidth"
            [igxForTrackBy]="grid.trackColumnChanges" [igxForSizePropName]="'calcPixelWidth'"
            [igxForScrollOrientation]="'horizontal'">
            <igx-grid-header-group [ngClass]="column.headerGroupClasses"
                [ngStyle]="column.headerGroupStyles |igxHeaderGroupStyle:column:grid.pipeTrigger" [column]="column"
                [style.min-width]="column.calcWidth | igxHeaderGroupWidth:grid.defaultHeaderGroupMinWidth:hasMRL"
                [style.flex-basis]="column.calcWidth | igxHeaderGroupWidth:grid.defaultHeaderGroupMinWidth:hasMRL">
            </igx-grid-header-group>
        </ng-template>

        <!-- Pinned columns collection at the end -->
        <ng-container *ngIf="pinnedColumnCollection.length && !grid.isPinningToStart">
            <ng-container *ngFor="let column of pinnedColumnCollection | igxTopLevel">
                <igx-grid-header-group [ngClass]="column.headerGroupClasses"
                    [ngStyle]="column.headerGroupStyles |igxHeaderGroupStyle:column:grid.pipeTrigger" [column]="column"
                    [style.min-width]="column.calcWidth | igxHeaderGroupWidth:grid.defaultHeaderGroupMinWidth:hasMRL"
                    [style.flex-basis]="column.calcWidth | igxHeaderGroupWidth:grid.defaultHeaderGroupMinWidth:hasMRL"
                    [style.left]="column.rightPinnedOffset">
                </igx-grid-header-group>
            </ng-container>
        </ng-container>
    </div>
</div>
<!-- Header thumb area -->
<div *ngIf="!row" class="igx-grid-thead__thumb" [hidden]="!grid.hasVerticalScroll()" [style.width.px]="grid.scrollSize">
</div>

<igx-drop-down #dropdown (selectionChanging)='onAggregationChange($event)' (closing)="onClosing($event)">
    <igx-drop-down-item *ngFor="let item of aggregateList" [selected] ='isSelected(item)' [value]='item'>
        {{ item.label }}
    </igx-drop-down-item>
</igx-drop-down>